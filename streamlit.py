
import streamlit as st
import matplotlib.pyplot as plt
import seaborn as sns
import matplotlib.font_manager as fm
import arabic_reshaper
#from bidi.algorithm import get_display
import pandas as pd

# تحميل البيانات (استبدلها ببياناتك الفعلية)
data = {
    'Year': [2018, 2019, 2020, 2021, 2022],
    'Type': ['Corolla', 'Camry', 'Corolla', 'Camry', 'Corolla'],
    'Count': [150, 120, 180, 160, 200]
}

type_by_year_region = pd.DataFrame(data)

# إعداد الخط العربي
font_path = "/System/Library/Fonts/Supplemental/Arial Unicode.ttf"
prop = fm.FontProperties(fname=font_path)

reshaped_title = get_display(arabic_reshaper.reshape('عدد سيارات Toyota حسب النوع والسنة'))
reshaped_xlabel = get_display(arabic_reshaper.reshape('السنة'))
reshaped_ylabel = get_display(arabic_reshaper.reshape('عدد السيارات'))
reshaped_legend = get_display(arabic_reshaper.reshape('نوع السيارة'))

# إضافة الشعار والعنوان في Streamlit
col1, col2 = st.columns([1, 3])
with col1:
    st.image("IMG_4670.png", width=150)
with col2:
    st.title("السعوديين وتويوتا: علاقة أسطورية في سوق المستعمل!")

# إضافة الصورة بعد القسم "📈 شارت ولاء السعوديين لتويوتا"
# المقدمة
st.write(
    """
    لو تدخل أي **سوق سيارات مستعملة** في السعودية، أول شيء يلفت انتباهك؟ **تويوتا مسيطرة بكل مكان!** 🚗  
    بس وش السبب؟ ليش الناس تحب تشتري وتبيع تويوتا بالذات؟
    """
)

# ولاء السعوديين لتويوتا
st.write("### 📈 ولاء السعوديين لتويوتا")
st.image("image.png", width=850)
st.write(
    """
    العلاقة بدأت من أكثر من **45 سنة**، ولا زالت مستمرة لأن سيارات تويوتا تتميز بـ:
    
    ✅ **الاعتمادية الفوق العادة** – تمشي معك سنين وما تخذلك!  
    ✅ **الصيانة السهلة والرخيصة** – أي ورشة تفهم فيها.  
    ✅ **قطع الغيار بكل مكان** – ما تحتاج تدور أو تنتظر شحن.
    """
)

# أكثر السيارات المعروضة للبيع
st.write("### 🚙 شارت أكثر السيارات المعروضة للبيع")
st.image("image copy.png", width=850)

st.write(
    """
        - في **جدة**، الكامري أكثر سيارة معروضة للبيع، يمكن لأن أهلها يحبون السيارات الاقتصادية للكرف اليومي.  
    - في **الرياض**، الاندكروزر متصدر، لأن أهل العاصمة يعشقون الطلعات والبر ويحتاجون سيارة قوية.
    - زاد عدد سيارات **تويوتا** بشكل ملحوظ مع مرور السنوات، خاصة بعد عام 2010، ووصل إلى أعلى مستوياته بين عامي 2016 و2020. بعض الموديلات مثل **لاند كروزر، راف 4، وكامري** كانت الأكثر انتشارًا مقارنةً بالبقية.
    """
)
st.write(
    """
    تويوتا ما خلت أحد، عندها سيارات تناسب **كل الفئات**:
    
    - راعي **بر**؟ أكيد تفكر في **لاندكروزر** 🏜️  
    - طالب جامعي؟ **كامري** أو **كورولا** خيار ممتاز 🎓  
    - تدور سيارة اقتصادية وعملية؟ عندك **يارس** و**هايلكس** 💰
    """
)

# أكثر السيارات بيعًا حسب المناطق
st.write("### 📊 المناطق والسيارات الأكثر بيعًا")
st.image("image copy 2.png", width=850)
st.write(
    """
    - **لاند كروزر** متسيدة السوق 🚙💨
    - **الرياض** متصدرة بفرق كبير، بعدها الدمام، وجدة، وهذا يدل إن الناس يحبونها، خاصة في المدن الكبيرة والمناطق البرية.
    - **الكامري** عليها طلب بعد 🚗🔥
    - جالسة تنافس بقوة في **جدة** والقصيم وعسير، واضح إنها مفضلة عند اللي يدورون سيارات سيدان عملية.
    - **الهيلوكس** و**الكورولا** منتشرين بس مو بقوة 🛻🚘
        - الهيلوكس موجودة في بعض المناطق، يمكن اللي عندهم شغل في البر والمزارع يفضلونها.
        - الكورولا بعد متواجدة بس بشكل أقل، يمكن الناس تفضل السيارات الأكبر.
    """
)


# أكثر فئة مواصفات معروضة للبيع بالسوق السعودي
st.write("### أكثر فئة مواصفات معروضة للبيع بالسوق السعودي")
st.image("image copy 3.png", width=850)
st.write(
    """
    - **الفل كامل** مسيطر 🔥🔵
        - أغلب المناطق تفضل الفل كامل، واضح إن الناس يحبون المواصفات الكاملة وما يبون يتنازلون عن أي ميزة.
    - **السيمي فل** موجود بس مو بنفس القوة 🟠
        - فيه كم منطقة تفضل السيمي فل، يمكن عشان سعره يكون أقل شوي لكنه يعطي بعض المزايا المهمة.
    - **الستاندرد** قليل جداً 🟢
        - عدد قليل جداً من المناطق تفضل الستاندرد، وهذا يدل إن الناس يميلون للسيارات المجهزة بمواصفات أكثر، حتى لو كانت بس سيمي فل.
    """
)


# الخاتمة
st.write(
    """
    **الخلاصة؟** تويوتا في سوق المستعمل مثل الذهب، تمسك سعرها، وتلقى لها زبون بأي وقت! 🚗💰
    """
)

# رسم المخطط
fig, ax = plt.subplots(figsize=(14, 8))
sns.set_style("whitegrid")
sns.set_palette("bright")

hue_order = type_by_year_region['Type'].unique()
